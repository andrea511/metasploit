class CreateNexposeDataVulnerabilityDefinitions < ActiveRecord::Migration[4.2]
  def change
    create_table :nexpose_data_vulnerability_definitions do |t|
      t.string :vulnerability_definition_id
      t.string :title
      t.text :description
      t.date :date_published
      t.integer :severity_score
      t.string :serverity
      t.string :pci_severity_score
      t.string :pci_status
      t.decimal :riskscore
      t.string :cvss_vector
      t.string :cvss_access_vector_id
      t.string :cvss_access_complexity_id
      t.string :cvss_authentication_id
      t.string :cvss_confidentiality_impact_id
      t.string :cvss_integrity_impact_id
      t.string :cvss_availability_impact_id
      t.decimal :cvss_score
      t.decimal :cvss_exploit_score
      t.decimal :cvss_impact_score
      t.boolean :denial_of_service

      t.timestamps null: false
    end
    add_index :nexpose_data_vulnerability_definitions, :vulnerability_definition_id,
              :name => "index_nx_data_vuln_def_on_vulnerability_definition_id",
              :unique => true
  end
end
