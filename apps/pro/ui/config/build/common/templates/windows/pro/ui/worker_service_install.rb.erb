#!ruby.exe

require 'rubygems'
require 'win32/service'

unless Win32::Service.exists?('@@BITROCK_WORKER_SERVICE_NAME@@')
  Win32::Service.new(
    :service_name      => '@@BITROCK_WORKER_SERVICE_NAME@@',
    :display_name      => '@@BITROCK_WORKER_DISPLAY_NAME@@',
    :start_type        => Win32::Service::AUTO_START,
    :binary_path_name  => '@@BITROCK_INSTALLDIR@@\ruby\bin\ruby.exe -C "@@BITROCK_INSTALLDIR@@\apps\pro\ui" worker_service.rb',
    :service_type      => Win32::Service::WIN32_OWN_PROCESS
  )
end
