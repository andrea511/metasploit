<% content_for :head do %>
  <meta name="msp:module_run_path" content="<%= new_module_run_path(@workspace.id, '') %>" />
<% end %>

<%= form_tag '',  :method => "POST", :id => 'new_module_run' do |f| %>
<%= hidden_field_tag 'host_ids[]', @vuln.host.id, :id => "host_ids_#{@vuln.host.id}_module" %>
<% end %>



<% @exploits.each do |exp| %>

<div class='details_header'>
<h1>
	<%= exp.mtype.capitalize %>: <%= exp.name %> ( <%= link_to h("Launch"), "#", :class => "module-name", :module_fullname => exp.fullname %> )
</h1>
</div>

<table class='details'>

<tr>
	<td class='field'>Description</td>
</tr>
<tr>
	<td class='value'>
		<pre class='verbose'><%= exp.description.split(/\s+/).map{|x| x.strip }.join(" ") %></pre>
	</td>
</tr>


<tr>
	<td class='field'>
		Module Details
	</td>
</tr>
<tr>
	<td class='value'>

<table class='nexpose_details'>

<%
	exp_fields = %W{ name fullname rank  disclosure_date privileged stance }

exp_fields.each do |k|
	next unless exp[k]

	kn = k.split('_').map{|x| x.capitalize }.join(" ")
%>
<tr>
	<td class='nexpose_field'>
		<%= kn %>
	</td>
	<td class='nexpose_value'>
<%=
		case k
		when 'rank'
			module_star_icons(exp.rank)
		when 'disclosure_date'
			exp[k].strftime('%Y-%m-%d')
		else
			exp[k]
		end
%>
	</td>
</tr>
<% end %>

</table>

	</td>
</tr>

</table>

<% end %>
