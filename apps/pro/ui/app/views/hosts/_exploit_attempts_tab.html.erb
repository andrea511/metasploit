<% content_for :head do %>
  <meta name="msp:module_run_path" content="<%= new_module_run_path(@workspace.id, '') %>" />
<% end %>

<%= form_tag '',  :method => "POST", :id => 'new_module_run' do |f| %>
<%= hidden_field_tag 'host_ids[]', @host.id, :id => "host_ids_#{@host.id}_module" %>
<% end %>


<table class="sortable list" id="attempts-table">
  <thead>
    <tr>
      <th>User</th>
      <th>Exploit</th>
      <th>Port</th>
      <th>Proto</th>
      <th>Result</th>
      <th>Detail</th>
      <th>Time</th>
    </tr>
  </thead>
  <tbody>
  <% reset_cycle "rows" %>
  <% @exploit_attempts.each do |att| %>
    <tr class="<%=h row_cycle %>">
      <td><%= att.username.to_s %></td>
      <td><%= link_to att.module_name, "#", :class => "module-name", :module_fullname => att.module %></td>
      <td><%= att.port %></td>
      <td><%= att.proto %></td>
      <td><%=
          att.exploited ? 
          ( att.session_id ? 
            link_to("Exploited", session_history_path(@workspace, att.session_id)) :
            "Exploited"
          ) : 
          "#{att.fail_reason.to_s.upcase}" 
      %></td>
      <td><%= truncate(att.fail_detail.to_s, :length => 120) %></td>
      <td width="170">
        <%= att.attempted_at.strftime('%Y-%m-%d %H:%M:%S %z').to_s %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>
