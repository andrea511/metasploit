module Mdm::Session::ViaExploit
  extend ActiveSupport::Concern

  included do
    after_create :adjust_via_exploit
  end

  private

  def adjust_via_exploit
    parent_module =  self.datastore['ParentModule']

    if parent_module
      self.via_exploit = parent_module
      self.save
    end
  end
end