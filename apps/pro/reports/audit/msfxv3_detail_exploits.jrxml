<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="msfxv3_compromised_creds" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="a90179a2-b053-4b92-a3a1-5ac93eb0707e">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Title" fontName="Serif" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" forecolor="#666666" fontName="Serif" fontSize="18"/>
	<style name="Column header" forecolor="#666666" fontName="Serif" fontSize="12" isBold="true"/>
	<style name="Detail" fontName="Serif" fontSize="12"/>
	<parameter name="host_id" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[0]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT DISTINCT
    v.name as vuln_name,
    va.module as exploit_module
FROM
    vuln_attempts va
    INNER JOIN vulns v ON (va.vuln_id = v.id)
    LEFT OUTER JOIN vulns_refs vr ON (vr.vuln_id = v.id)
    LEFT OUTER JOIN refs r ON (vr.ref_id = r.id)
WHERE
    va.exploited = true
    and v.host_id = $P{host_id}
ORDER BY
    v.name, va.module]]>
	</queryString>
	<field name="vuln_name" class="java.lang.String"/>
	<field name="exploit_module" class="java.lang.String"/>
	<pageHeader>
		<band height="21">
			<line>
				<reportElement uuid="8d9cdabe-351b-4611-844d-bc942d13a587" positionType="FixRelativeToBottom" x="0" y="20" width="555" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement uuid="888e9c77-ccb2-48e8-9eec-4c1666b93c82" style="Column header" x="3" y="0" width="321" height="20"/>
				<textElement>
					<font fontName="SansSerif" size="10"/>
				</textElement>
				<text><![CDATA[Vulnerability Name]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="4650762c-4e9d-4b1a-8780-e67a592127c2" style="Column header" x="324" y="0" width="231" height="20"/>
				<textElement>
					<font fontName="SansSerif" size="10"/>
				</textElement>
				<text><![CDATA[Exploit Module]]></text>
			</staticText>
		</band>
	</pageHeader>
	<detail>
		<band height="17" splitType="Stretch">
			<line>
				<reportElement uuid="6ef6f8e5-2d39-4e1e-9771-0898223de08a" positionType="FixRelativeToBottom" x="3" y="15" width="555" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5" lineColor="#999999"/>
				</graphicElement>
			</line>
			<textField>
				<reportElement uuid="2bcd1721-d8d3-4cff-aeed-2393ec672053" style="Detail" x="3" y="2" width="321" height="15"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[null==$F{vuln_name} ? "<none>" : $F{vuln_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="4f835f6a-81a5-4bd9-9818-fbcbf99a7b34" style="Detail" x="324" y="1" width="231" height="15"/>
				<textElement verticalAlignment="Middle">
					<font fontName="SansSerif" size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{exploit_module}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
